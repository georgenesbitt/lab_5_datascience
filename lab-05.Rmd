---
title: "Lab 05 - La Quinta is Spanish for next to Denny's, Pt. 2"
author: "George Nesbitt"
date: "02/13/2026"
output: github_document
---

### Load packages and data




```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

### Exercise 1

```{r}
dn_ak <- dennys %>%
  filter(state == "AK")
nrow(dn_ak)
```
```{r}
lq_ak <- laquinta %>%
  filter(state == "AK")
nrow(lq_ak)
```

There are three Denny's in Alaska and two LaQuintas

### Exercise 2
We need to calculate six distances because there are three Denny's and two LaQuintas (3*2)=6


### Exercise 3
```{r}
dn_lq_ak <- full_join(dn_ak, lq_ak,
  by = "state"
)
dn_lq_ak
```


### Exercise 4
```{r}
glimpse(dn_lq_ak)
```
There are 6 observations and 11 variables. They are: address, city, state (denny's only), zip, longitude, latitude. All variables except for state are listed for both dennys and laquinta/ .

### Exercise 5
We use the function mutate() to add a new variable to a data frame while keeping the existing variables.
...
```{r}
haversine <- function(long1, lat1, long2, lat2, round = 3) {
  # convert to radians
  long1 <- long1 * pi / 180
  lat1 <- lat1 * pi / 180
  long2 <- long2 * pi / 180
  lat2 <- lat2 * pi / 180

  R <- 6371 # Earth mean radius in km

  a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round)) # distance in km
}
```

### Exercise 6
```{r}
dn_lq_ak <- dn_lq_ak %>%
  mutate(distance = haversine(latitude.y, longitude.y, latitude.x, longitude.x, round=3))

```

### Excercise 7
```{r}
dn_lq_ak <- dn_lq_ak %>%
  group_by(latitude.x, longitude.x) %>%
  mutate(min_distance = min(distance, na.rm = TRUE)) %>%
  ungroup()

```

### Excercise 8
```{r}
dn_lq_ak %>%
  summarise(
    n_dennys = n(),
    mean = mean(min_distance, na.rm = TRUE),
    sd = sd(min_distance, na.rm = TRUE),
    median = median(min_distance, na.rm = TRUE),
    iqr = IQR(min_distance, na.rm = TRUE),
    min = min(min_distance, na.rm = TRUE),
    max = max(min_distance, na.rm = TRUE)
  )

```
```{r}
ggplot(dn_lq_ak %>% group_by(min_distance),
       aes(x = min_distance, y = 0)) +
  geom_point(size = 4) +
  labs(
    title = "Nearest La Quinta distance for each Alaska Denny’s",
    x = "Minimum distance to nearest La Quinta (km)")

```
There are three Denny's which I have graphed above on a single planed line showing the minimum distance each location is to the nearest La Quinta. The mean distance is 9.145333 and the SD is 4.010.

### Excercise 9
```{r}
lq_nc <- laquinta %>%
  filter(state == "NC")
nrow(lq_nc)

dn_nc <- dennys %>%
  filter(state == "NC")
nrow(dn_nc)
```
```{r}
dn_lq_nc <- full_join(dn_nc, lq_nc,
  by = "state"
)
dn_lq_nc
```
```{r}
dn_lq_nc <- dn_lq_nc %>%
  mutate(distance = haversine(latitude.y, longitude.y, latitude.x, longitude.x, round=3))

```
```{r}
dn_lq_nc <- dn_lq_nc %>%
  group_by(latitude.x, longitude.x) %>%
  mutate(min_distance = min(distance, na.rm = TRUE)) %>%
  ungroup()

```

```{r}
dn_lq_nc %>%
  summarise(
    n_dennys = n(),
    mean = mean(min_distance, na.rm = TRUE),
    sd = sd(min_distance, na.rm = TRUE),
    median = median(min_distance, na.rm = TRUE),
    iqr = IQR(min_distance, na.rm = TRUE),
    min = min(min_distance, na.rm = TRUE),
    max = max(min_distance, na.rm = TRUE)
  )

```

```{r}
ggplot(dn_lq_nc %>% group_by(min_distance),
       aes(x = min_distance, y = 0)) +
  geom_point(size = .5) +
  labs(
    title = "Nearest La Quinta distance for each NC Denny’s",
    x = "Minimum distance to nearest La Quinta (km)")

```
Above you can see the distribution of all 336 (lol wsnc zip area code) locations of denny's and their proximity to the closest laquintas. There is a pretty spread out distribution, especially from 0 to 100 kms. Unlike Alaska, there are denny's way far away from any LaQuintas. The mean of the data is 48.33393	km and the SD is 45.07359	km.


### Excercise 9
```{r}
lq_tx <- laquinta %>%
  filter(state == "TX")
nrow(lq_tx)

dn_tx <- dennys %>%
  filter(state == "TX")
nrow(dn_tx)
```
```{r}
dn_lq_tx <- full_join(dn_tx, lq_tx,
  by = "state"
)
dn_lq_tx
```
```{r}
dn_lq_tx <- dn_lq_tx %>%
  mutate(distance = haversine(latitude.y, longitude.y, latitude.x, longitude.x, round=3))

```
```{r}
dn_lq_tx <- dn_lq_tx %>%
  group_by(latitude.x, longitude.x) %>%
  mutate(min_distance = min(distance, na.rm = TRUE)) %>%
  ungroup()

```

```{r}
dn_lq_tx %>%
  summarise(
    n_dennys = n(),
    mean = mean(min_distance, na.rm = TRUE),
    sd = sd(min_distance, na.rm = TRUE),
    median = median(min_distance, na.rm = TRUE),
    iqr = IQR(min_distance, na.rm = TRUE),
    min = min(min_distance, na.rm = TRUE),
    max = max(min_distance, na.rm = TRUE)
  )

```

```{r}
ggplot(dn_lq_tx %>% group_by(min_distance),
       aes(x = min_distance, y = 0)) +
  geom_point(size = .5) +
  labs(
    title = "Nearest La Quinta distance for each Texas Denny’s",
    x = "Minimum distance to nearest La Quinta (km)")

```
The Texas one proves the Hedberg joke much more than the NC one and provides a greater range of data than the AK one. There are a vast majority of Denny's with distances within 20 km of a La Quinta. There is one clear outlier past the 50 km mark.
The mean is 2.73755	and the SD is 4.843115.


### Excercise 11
```{r}
lq_or <- laquinta %>%
  filter(state == "OR")
nrow(lq_or)

dn_or <- dennys %>%
  filter(state == "OR")
nrow(dn_or)
```
```{r}
dn_lq_or <- full_join(dn_or, lq_or,
  by = "state"
)
dn_lq_or
```
```{r}
dn_lq_or <- dn_lq_or %>%
  mutate(distance = haversine(latitude.y, longitude.y, latitude.x, longitude.x, round=3))

```
```{r}
dn_lq_or <- dn_lq_or %>%
  group_by(latitude.x, longitude.x) %>%
  mutate(min_distance = min(distance, na.rm = TRUE)) %>%
  ungroup()

```

```{r}
dn_lq_or %>%
  summarise(
    n_dennys = n(),
    mean = mean(min_distance, na.rm = TRUE),
    sd = sd(min_distance, na.rm = TRUE),
    median = median(min_distance, na.rm = TRUE),
    iqr = IQR(min_distance, na.rm = TRUE),
    min = min(min_distance, na.rm = TRUE),
    max = max(min_distance, na.rm = TRUE)
  )

```

```{r}
ggplot(dn_lq_or %>% group_by(min_distance),
       aes(x = min_distance, y = 0)) +
  geom_point(size = .5) +
  labs(
    title = "Nearest La Quinta distance for each Oregon Denny’s",
    x = "Minimum distance to nearest La Quinta (km)")

```
In this distribution, there is a large distribution of data points arranged between 0 and 50 km however there are 5 data points that are within the 100-500km range with one even ranging all the way to what looks like 480km distance.

The mean is 76.60392 and the SD is	130.8993.

### Excercise 12
To me, I think from the data that I have seen, the correlation between Denny's locations and LQ locations does not seem to be significant. I think that while there are certainly plenty, probably even the majority, of Denny's locations that are within 5kms of a LaQuinta, I think you could probably say the exact same thing about mcdonalds and motel 6 or any other crappy hotel/fast food restraunt chain. There does not seem to be any credible statistical evidence that this is unique nor significant. 

